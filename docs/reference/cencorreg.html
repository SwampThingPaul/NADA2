<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Correlation and Regression with censored data — cencorreg • NADA2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Correlation and Regression with censored data — cencorreg"><meta property="og:description" content="Computes three parametric correlation coefficients for one X variable and the corresponding R squared for multiple X variables, and a regression equation for censored data."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NADA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Censored_Data_Analysis.html">Censored Data Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SwampThingPaul/NADA2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correlation and Regression with censored data</h1>
    <small class="dont-index">Source: <a href="https://github.com/SwampThingPaul/NADA2/blob/HEAD/R/cencorreg.R" class="external-link"><code>R/cencorreg.R</code></a></small>
    <div class="hidden name"><code>cencorreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes three parametric correlation coefficients for one X variable and the corresponding R squared for multiple X variables, and a regression equation for censored data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cencorreg</span><span class="op">(</span></span>
<span>  <span class="va">y.var</span>,</span>
<span>  <span class="va">cen.var</span>,</span>
<span>  <span class="va">x.vars</span>,</span>
<span>  LOG <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  pred.plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pred.col <span class="op">=</span> <span class="st">"purple"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y.var</dt>
<dd><p>The column of y (response variable) values plus detection limits.</p></dd>


<dt>cen.var</dt>
<dd><p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value is in <code>y.var</code>.</p></dd>


<dt>x.vars</dt>
<dd><p>One or more uncensored explanatory variable(s). For multiple variables it must be a data frame of numeric, character and factor variables. See Details</p></dd>


<dt>LOG</dt>
<dd><p>Indicator of whether to compute the regression in the original y units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p></dd>


<dt>verbose</dt>
<dd><p>default <code>verbose=2</code>, see details.</p></dd>


<dt>pred.plot</dt>
<dd><p>default is FALSE. Produces a plot of data and regression model predictions.  To do this the first (or only) x variable in the X dataframe must be a continuous (not factor) variable, and it becomes the x variable in the plot.</p></dd>


<dt>pred.col</dt>
<dd><p>default is "purple".  Changes the color of the predicted lines in the prediction plot.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>When <code>x.vars</code> is one variable, likelihood, rescaled likelihood and McFaddens correlation coefficient (<code>R</code>) are printed.
When <code>x.vars</code> is a <code>data.frame</code> of more than one variable, likelihood, rescaled likelihood and McFaddens coefficent of determination (<code>R2</code>) are printed.</p>


<p>Model coefficients (intercept and slopes), Chi-Squared statistic and p-value for the test that all slope coefficients equal zero (overall test), and model AIC and BIC are provided.</p>


<p>A Q-Q plot of model residuals with corresponding Shapiro-Francia W and p-value are plotted for evaluation of model distributional assumptions when <code>verbose=2</code> (the default).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>x.vars</code>: If one x variable only, enter its name.  If multiple x variables, enter the name of a data frame of columns of the x variables. Only columns used as <code>X</code> variables in the regression are allowed. Create this by <code>x.frame &lt;- data.frame (Temp, Flow, Time)</code> for 3 variables (temperature, flow and time) used as the <code>X</code> variables in the regression.  To produce a pred.plot plot of predicted values the first variable in the array must be a continuous (not a factor) variable.</p>
<p>AIC and BIC are printed to help evaluate the ‘best’ regression model.  Lower values are better when comparing models with the same Y units and same data.Cannot be used to compare models with differing Y units (such as Y~X versus logY~X). Can be used to compare models with differing X units such as Y~X vs Y~logX.</p>
<p>The default Y units are that the Y variable will be log transformed.  Change this with the LOG = option, setting LOG = FALSE.</p>
<p><code>verbose</code> option. Default is 2 which provides full output in the console and qqplots in a graphics window. A value of 1 only provides partial results in the console and no plots. A value of 0 provides no output; the returning computations will be stored in the specified object.</p>
<p>The Y parameter in the model output (modelname$y) is -1 times the data that were input. This is due to the shift from left censored data to the required right censored data of the survreg function.  The original data are not changed and are used to draw the pred.plot.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.</p>
<p>Helsel, D.R., 2005. Nondetects and Data Analysis: Statistics for Censored Environmental Data, 1st ed. John Wiley and Sons, USA, N.J.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survival::survreg</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># One variable</span></span></span>
<span class="r-in"><span><span class="fu">cencorreg</span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">$</span><span class="va">Hg</span>,<span class="va">Brumbaugh</span><span class="op">$</span><span class="va">HgCen</span>,<span class="va">Brumbaugh</span><span class="op">$</span><span class="va">SedMeHg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Likelihood R2 = 0.07647                     AIC = 366.2191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Rescaled Likelihood R2 = 0.08152             BIC = 373.9126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  McFaddens R2 = 0.02860934 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> survreg(formula = "log(Brumbaugh$Hg)", data = "Brumbaugh$SedMeHg", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dist = "gaussian")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         (Intercept) `Brumbaugh$SedMeHg` </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1.7594846           0.1238447 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale= 0.960393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglik(model)= -179.6   Loglik(intercept only)= -184.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Chisq= 10.58 on 1 degrees of freedom, p= 0.00114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 133 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># One variable with pred.plot=T</span></span></span>
<span class="r-in"><span><span class="fu">cencorreg</span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">$</span><span class="va">Hg</span>,<span class="va">Brumbaugh</span><span class="op">$</span><span class="va">HgCen</span>,<span class="va">Brumbaugh</span><span class="op">$</span><span class="va">SedMeHg</span>,pred.plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cencorreg-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Likelihood R2 = 0.07647                     AIC = 366.2191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Rescaled Likelihood R2 = 0.08152             BIC = 373.9126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  McFaddens R2 = 0.02860934 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-plt img"><img src="cencorreg-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> survreg(formula = "log(Brumbaugh$Hg)", data = "Brumbaugh$SedMeHg", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dist = "gaussian")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         (Intercept) `Brumbaugh$SedMeHg` </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1.7594846           0.1238447 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale= 0.960393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglik(model)= -179.6   Loglik(intercept only)= -184.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Chisq= 10.58 on 1 degrees of freedom, p= 0.00114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 133 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># More than one variable for demostration purposes</span></span></span>
<span class="r-in"><span><span class="fu">cencorreg</span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">$</span><span class="va">Hg</span>,<span class="va">Brumbaugh</span><span class="op">$</span><span class="va">HgCen</span>,<span class="va">Brumbaugh</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SedMeHg"</span>,<span class="st">"PctWetland"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cencorreg-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Likelihood R2 = 0.1371                     AIC = 359.1937 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Rescaled Likelihood R2 = 0.1461             BIC = 369.7851 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  McFaddens R2 = 0.05301555 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> survreg(formula = "log(Brumbaugh$Hg)", data = "SedMeHg+PctWetland", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dist = "gaussian")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     SedMeHg  PctWetland </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.79140776  0.06634913  0.01402344 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale= 0.9264126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglik(model)= -175.1   Loglik(intercept only)= -184.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Chisq= 19.61 on 2 degrees of freedom, p= 5.53e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 133 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul Julian, Dennis Helsel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

