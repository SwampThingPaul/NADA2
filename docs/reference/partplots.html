<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Partial plots for censored MLE regression — partplots • NADA2</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Partial plots for censored MLE regression — partplots" />
<meta property="og:description" content="Draws a partial plot for each X variable in regression of a censored Y variable against multiple X variables." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NADA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/DataAnalysis.html">Censored Data Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SwampThingPaul/NADA2/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Partial plots for censored MLE regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/SwampThingPaul/NADA2/blob/master/R/partplots.R'><code>R/partplots.R</code></a></small>
    <div class="hidden name"><code>partplots.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draws a partial plot for each X variable in regression of a censored Y variable against multiple X variables.</p>
    </div>

    <pre class="usage"><span class='fu'>partplots</span><span class='op'>(</span>
  <span class='va'>y.var</span>,
  <span class='va'>cen.var</span>,
  <span class='va'>x.vars</span>,
  LOG <span class='op'>=</span> <span class='cn'>TRUE</span>,
  smooth.method <span class='op'>=</span> <span class='st'>"gam"</span>,
  gam.method <span class='op'>=</span> <span class='st'>"tp"</span>,
  multiplot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  printstat <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y.var</th>
      <td><p>The column of y (response variable) values plus detection limits.</p></td>
    </tr>
    <tr>
      <th>cen.var</th>
      <td><p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p></td>
    </tr>
    <tr>
      <th>x.vars</th>
      <td><p>Multiple uncensored explanatory variable(s). See Details</p></td>
    </tr>
    <tr>
      <th>LOG</th>
      <td><p>Indicator of whether to compute the censored regression in the original y units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original Y units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p></td>
    </tr>
    <tr>
      <th>smooth.method</th>
      <td><p>Method for drawing a smooth on the partial plot.  Options are c("gam", "none"). "gam" is a censored generalized additive model using the cenGAM and mgcv packages.</p></td>
    </tr>
    <tr>
      <th>gam.method</th>
      <td><p>Method for computing the gam smooth.  See the mgcv package for options.  Default is a thinplate ("tp") spline.  "cs" is another good option.</p></td>
    </tr>
    <tr>
      <th>multiplot</th>
      <td><p>If TRUE, plots are drawn 6 per page.  If FALSE, all plots are drawn on a separate page.</p></td>
    </tr>
    <tr>
      <th>printstat</th>
      <td><p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>When <code>x.vars</code> is one variable, a message is printed that partial plots are not possible with only one X variable and execution stops.
When <code>x.vars</code> is a data frame of more than one variable, partial plots are drawn for each X variable and text is printed comparing AICs for regression using the untransformed X variable with log and cube-root transforms of the X variable, as a supplement to evaluating linearity on the partial plots alone.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Partial plots for uncensored data often are drawn with superimposed smooths. At times looking only at the data values without a smooth can better enable the human eye to determine whether the overall pattern is linear or not.  If this is the best method for you, use the smooth.method = "none" option to not draw a smooth.  The most common smooth used for uncensored data is loess, which does not recognize censored data and so uses the detection limit (DL) value itself.  This results in biased-high smooths that incorrectly treat values at the DLs equal to uncensored (detected) data. The partplots function in NADA2 was written to provide a better alternative, smoothing the partial residual pattern with a censored generalized additive model (gam).  The censored gam recognizes the nondetects as left-censored data with a maximum at the DL when computing the smooth. DLs may vary with each observation -- multiple DLs in a dataset are not a problem in routines of the NADA2 package.</p>
<p>'y.var': The default is that the Y variable will be log transformed.</p>
<p><code>x.vars</code>: Enter the name of a data frame of columns of the x variables. No extra columns unused in the regression allowed. Create this by <code>x.frame &lt;- data.frame (Temp, Flow, Time)</code> for 3 variables (temperature, flow and time).</p>
<p>Gray open circles represent censored data and are the residual between the detection limit and the predicted value from the censored regression.  The GAM recognizes that the detection limit is an upper limit, predicted values on the regression line are most often below the detection limit, leading to positive residuals.  Note that the true residual for censored data could be anywhere below the plotted value.  That fact is recognized by the censored GAM but is difficult to represent on a plot.</p>
<p>AIC for regression models with un-transformed X, log and cube-root transforms of X are printed to evaluate which of the three transformations results in the ‘best’ model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.</p>
<p>Cook, R.D., 1993. Exploring Partial Residual Plots, Technometrics 35, 351-362.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/pkg/survival/man/survreg.html'>survival::survreg</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Brumbaugh</span><span class='op'>)</span>

<span class='co'># For demostration purposes</span>
<span class='fu'>partplots</span> <span class='op'>(</span><span class='va'>Brumbaugh</span><span class='op'>$</span><span class='va'>Hg</span>,<span class='va'>Brumbaugh</span><span class='op'>$</span><span class='va'>HgCen</span>,<span class='va'>Brumbaugh</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SedMeHg"</span>,<span class='st'>"PctWetland"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; SedMeHg 
#&gt;  untransformed 
#&gt;  Likelihood R2 = 0.01798                     AIC = 40.16894 
#&gt; cube root 
#&gt;  Likelihood R2 = 0.01336                     AIC = 40.79301 
#&gt; log transform 
#&gt;  Likelihood R2 = 0.01339                     AIC = 40.79012 
#&gt; Decrease in AIC from transformation of SedMeHg = 0 
#&gt;  </div><div class='img'><img src='partplots-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; PctWetland 
#&gt;  untransformed 
#&gt;  Likelihood R2 = 0.01798                     AIC = 40.16894 
#&gt; cube root 
#&gt;  Likelihood R2 = 0.02204                     AIC = 39.61784 
#&gt; log transform 
#&gt; Cannot take logs of zero or negative values. 
#&gt; Decrease in AIC from transformation of PctWetland = 0.5510965 
#&gt;  </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul Julian, Dennis Helsel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


