<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Seasonal Kendall permutation test on censored data — censeaken • NADA2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Seasonal Kendall permutation test on censored data — censeaken"><meta property="og:description" content="Seasonal Kendall permutation test on censored data"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NADA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Censored_Data_Analysis.html">Censored Data Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SwampThingPaul/NADA2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Seasonal Kendall permutation test on censored data</h1>
    <small class="dont-index">Source: <a href="https://github.com/SwampThingPaul/NADA2/blob/HEAD/R/censeaken.R" class="external-link"><code>R/censeaken.R</code></a></small>
    <div class="hidden name"><code>censeaken.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Seasonal Kendall permutation test on censored data</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">censeaken</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">y.cen</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  LOG <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">4999</span>,</span>
<span>  nmin <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seaplots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  printstat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>time</dt>
<dd><p>Column of the time variable, either a sequence of days or decimal times, etc.  Will be the scale used for time in the trend analysis.</p></dd>


<dt>y</dt>
<dd><p>The column of y (response variable) values plus detection limits</p></dd>


<dt>y.cen</dt>
<dd><p>The y-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p></dd>


<dt>group</dt>
<dd><p>Column of the season classifications. A factor in R, so usually though not necessarily a text variable.  If numeric, define as a factor before running the script.</p></dd>


<dt>LOG</dt>
<dd><p>Indicator of whether to compute the trend analysis in the original y units, or on their logarithms.  The default is to use the logarithms (LOG = <code>TRUE</code>).  To compute in original units, specify the option LOG = <code>FALSE</code> (or LOG = 0).</p></dd>


<dt>R</dt>
<dd><p>The number of repetitions in the permutation process.  R is often between 999 and 9999 (adding +1 to represent the observed test statistic produces 1000 to 10000 repetitions). By default R=4999. Increasing R results in lower variation in the p-values produced between runs.</p></dd>


<dt>nmin</dt>
<dd><p>The minimum number of observations needed for the entire time period to be tested, per season.  For example, with 1 sample per year per season over an 8-year period, you have 8 observations for each season.  You can increase this number if you want a higher minimum.  Don’t decrease it below the default of 4.  If there are fewer than nmin values that season is skipped and not included in the overall test and a note of this will be printed in the console.</p></dd>


<dt>seaplots</dt>
<dd><p>In addition to the plot of the overall Seasonal Kendall trend line, plots of the trend in individual seasons can also be drawn.</p></dd>


<dt>printstat</dt>
<dd><p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p></dd>


<dt>...</dt>
<dd><p>other inputs associated with modifying plots produced by this function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Prints the Kendall trend test results for each season individually. The overall Seasonal Kendall test and Theil-Sen line results are both printed and returned.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For each season the ATS function is used to compute the season's Kendall-S statistic and p-value for the trend test.  The test is the usual ATS procedure, not a permutation test.  For the overall test there are R (default 4999) random rearrangements of data that are generated with no mixing of data from one season to another season within a permutation -- data over time within a season are randomized.  This retains any between-seasons differences while removing any trend from year to year to use as the permuted "representation of the null hypothesis" of no trend in the R Seasonal Kendall tests. For a 2-sided trend test the p-value is the number of the absolute value of the permutation S statistics that are equal to or greater than the absolute value of the observed S from the original data, plus 1 (for the observed S of the original data), divided by the total (R+1) S values.</p>
<p>The censeaken function differs from other R packages that do not incorporate censored data in their trend tests (EnvStats, Kendall, rkt and others) in that censeaken uses all of the data across the years without an option to equalize each year's or season's influence by using the overall mean or median of the period's data rather than the original observations. Seasons with more data will have more influence on the outcome, just as years with more data will have more influence. If the numbers of observations differ enough between seasons or years that this is of concern, it is up to the user to perhaps eliminate some data in data-rich periods that are most unlike the conditions or times of data collected in sparse periods.  Or to compute summary statistics such as the median of each season/year combination and run the test on the medians, though this will result in a loss of power to detect trends and will require the user to use methods such as those in NADA2 to compute medians when there are censored data.</p>
<p>If <code>seaplots=TRUE</code> each season's trend line will be plotted seperately. A plot of the overall Seasonal Kendall (Akritas-Theil-Sen) line is always plotted.
If <code>seaplots=FALSE</code> only the overall Seasonal Kendall (Akritas-Theil-Sen) line will be plotted on a data scatterplot.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.</p>
<p>Hirsch, R.M., Slack, J.R., Smith, R.A., 1982. Techniques of Trend Analysis for Monthly Water Quality Data, Water Res. Reseach 18, 107-121.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/NADA/man/cenken.html" class="external-link">NADA::cenken</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Artificial time and season variables for demonstration purposes</span></span></span>
<span class="r-in"><span><span class="va">Brumbaugh</span><span class="op">$</span><span class="va">time</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Brumbaugh</span><span class="op">$</span><span class="va">sea</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Brumbaugh</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Brumbaugh</span>,<span class="fu">censeaken</span><span class="op">(</span><span class="va">time</span>,<span class="va">Hg</span>,<span class="va">HgCen</span>,<span class="va">sea</span>,seaplots <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DATA ANALYZED: Hg vs time by sea </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="censeaken-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Season  N S    tau    pval Intercept    slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 18 7 0.0458 0.82022   0.25226 0.001324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="censeaken-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Season  N  S    tau    pval Intercept     slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      2 38 36 0.0512 0.65925   0.12677 0.0002298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="censeaken-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Season  N   S     tau   pval Intercept      slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      3 46 -94 -0.0908 0.3782   0.22401 -0.0006805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="censeaken-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Season  N    S   tau     pval Intercept     slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      4 31 -130 -0.28 0.028006   0.41612 -0.002686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Seasonal Kendall test and Theil-Sen line </span>
<span class="r-plt img"><img src="censeaken-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   reps_R   N S_SK  tau_SK   pval intercept      slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4999 133 -181 -0.0768 0.2222   0.25022 -0.0004083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="censeaken-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul Julian, Dennis Helsel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

