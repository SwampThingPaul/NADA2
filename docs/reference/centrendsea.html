<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Trend analysis of censored data with a covariate and seasonal blocks — centrendsea • NADA2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Trend analysis of censored data with a covariate and seasonal blocks — centrendsea"><meta property="og:description" content="Computes the Seasonal Kendall trend test for censored data after adjustment of censored data for a covariate. The adjustment is by subtracting off a censored GAM smooth, removing the effect of the covariate.  Trend analysis is performed on the residuals from the GAM smooth."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NADA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Censored_Data_Analysis.html">Censored Data Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SwampThingPaul/NADA2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Trend analysis of censored data with a covariate and seasonal blocks</h1>
    <small class="dont-index">Source: <a href="https://github.com/SwampThingPaul/NADA2/blob/HEAD/R/centrendsea.R" class="external-link"><code>R/centrendsea.R</code></a></small>
    <div class="hidden name"><code>centrendsea.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the Seasonal Kendall trend test for censored data after adjustment of censored data for a covariate. The adjustment is by subtracting off a censored GAM smooth, removing the effect of the covariate.  Trend analysis is performed on the residuals from the GAM smooth.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">centrendsea</span><span class="op">(</span></span>
<span>  <span class="va">y.var</span>,</span>
<span>  <span class="va">y.cens</span>,</span>
<span>  <span class="va">x.var</span>,</span>
<span>  <span class="va">time.var</span>,</span>
<span>  <span class="va">season</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">4999</span>,</span>
<span>  nmin <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  Smooth <span class="op">=</span> <span class="st">"cs"</span>,</span>
<span>  printstat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seaplots <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y.var</dt>
<dd><p>The column of y (response variable) values plus detection limits</p></dd>


<dt>y.cens</dt>
<dd><p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detectionlimit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p></dd>


<dt>x.var</dt>
<dd><p>Column of a covariate (not time).  <code>y.var</code> will be smoothed versus <code>x.var</code> and residuals taken to subtract out the relationship between <code>y</code> and <code>x</code>.</p></dd>


<dt>time.var</dt>
<dd><p>Column of the numerical time variable, either a sequence of numbered days or decimal times, etc.  Will be the scale used for time in ATS trend analysis.</p></dd>


<dt>season</dt>
<dd><p>Column of the seasonal variable.  Usually a text variable but may be numeric.  Will be converted to a factor..</p></dd>


<dt>R</dt>
<dd><p>The number of repetitions in the permutation process.  R is often between 999 and 9999 (adding +1 to represent the observed test statistic produces 1000 to 10000 repetitions). By default R=4999. Increasing R results in lower variation in the p-values produced between runs.</p></dd>


<dt>nmin</dt>
<dd><p>The minimum number of observations needed for the entire time period to be tested, per season.  For example, with 1 sample per year per season over an 8-year period, you have 8 observations for each season.  You can increase this number if you want a higher minimum.  Don’t decrease it below the default of 4.  If there are fewer than nmin values that season is skipped and not included in the overall test and a note of this will be printed in the console.</p></dd>


<dt>link</dt>
<dd><p>Default = <code>"identity"</code> which means it uses data in the original units. See details.</p></dd>


<dt>Smooth</dt>
<dd><p>Type of smoother used in the GAM. Default is <code>"cs"</code>, shrinkage cubic regression splines. See details for other options.</p></dd>


<dt>printstat</dt>
<dd><p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p></dd>


<dt>seaplots</dt>
<dd><p>logical 'TRUE'/'FALSE' option to print plots with trend line for each season.  Default is 'TRUE'.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Prints four plots: 1. Y data vs X covariate with GAM Smooth, 2. Residuals from GAM Smooth vs X covariate, 3. histogram of the SK test results illlustrating the p-value, and 4. Seasonal Kendall trend line of residuals vs time.  Plots of data and SK trend line for each season are produced when the seaplots option is TRUE.</p>


<p>Returns the seasonal Kendall trend test results on residuals (intercept, slope, Kendall's tau, p-value for trend)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Default <code>link</code> = identity. The y variables are then used in their original units. Other options are available see <code><a href="https://rdrr.io/pkg/cenGAM/man/tobit1.html" class="external-link">cenGAM::tobit1</a></code> for more options.</p>
<p>Default <code>Smooth</code> is <code>"cs"</code> for shrinkage cubic regression splines. See <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">mgcv::smooth.terms</a></code> for other types of smoothing algorithms.  '"ts"' is a thin-plate regression spline and is also commonly used.</p>
<p>As with the censeaken function, observations are not edited when there are more data in some seasons than others. Seasons with more data will have more influence on the overall SK test than seasons with fewer data. To avoid this (as done with some Seasonal Kendall software) data in the seasons with more can be selectively deleted to better match the data frequency of the seasons with fewer data.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Gales_Creek</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Gales_Creek</span>,<span class="fu">centrendsea</span><span class="op">(</span><span class="va">TCr</span>,<span class="va">CrND</span>,<span class="va">discharge</span>,<span class="va">dectime</span>,<span class="va">Season</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="centrendsea-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="centrendsea-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trend analysis by Season of: TCr adjusted for discharge </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="centrendsea-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Season  N  S     tau    pval Intercept   slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Dry 34 -8 -0.0143 0.91638     34.52 -0.0172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="centrendsea-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Season  N   S    tau    pval Intercept    slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Wet 29 -58 -0.143 0.28481    86.864 -0.04316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Seasonal Kendall test and Akritas-Theil-Sen line on residuals </span>
<span class="r-plt img"><img src="centrendsea-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   reps_R  N S_SK  tau_SK   pval intercept    slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   4999 63  -66 -0.0683 0.4288    59.654 -0.02967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- </span>
<span class="r-plt img"><img src="centrendsea-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul Julian, Dennis Helsel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

